<student-mgmt-card class="assignment-card" data-test="assignment-card">
	<ng-container title>
		<span class="font-bold name">
			<a
				class="link-none"
				[routerLink]="[props.assignment.id, 'assessments']"
				*ngIf="props.participant.isTeachingStaffMember; else noLink"
			>
				{{ props.assignment.name }}
			</a>
			<ng-template #noLink>
				{{ props.assignment.name }}
			</ng-template>
		</span>
		<span class="state" [ngSwitch]="props.passFailSubmittedState">
			<student-mgmt-chip
				*ngSwitchCase="'submitted'"
				color="#14abb3"
				icon="assignment_turned_in"
				text="Abgegeben"
			></student-mgmt-chip>
			<student-mgmt-chip
				*ngSwitchCase="'passed'"
				color="#2fac6f"
				icon="thumb_up"
				[text]="'Property.Assessment.HasPassed' | translate"
			></student-mgmt-chip>
			<student-mgmt-chip
				*ngSwitchCase="'failed'"
				color="#ff0134"
				icon="thumb_down"
				[text]="'Domain.Failed' | translate"
			></student-mgmt-chip>
			<student-mgmt-chip
				*ngSwitchCase="'evaluated'"
				color="#5335b0"
				icon="assignment_turned_in"
				text="Bewertet"
			></student-mgmt-chip>
		</span>
	</ng-container>

	<ng-container subtitle>
		<span>
			<span>{{ props.assignment.points }} {{ "Domain.Points" | translate }}</span>
			<span *ngIf="props.assignment.bonusPoints && props.assignment.bonusPoints > 0">
				(+{{ props.assignment.points }} {{ "Property.Assignment.BonusPoints" | translate }})
			</span>
			<span *ngIf="props.requiredPoints">
				- {{ "Common.Required" | translate }}: {{ props.requiredPoints }}
				{{ "Domain.Points" | translate }}</span
			>
			<span *ngIf="props.assessment?.achievedPoints as achievedPoints">
				- {{ "Common.Achieved" | translate }}: {{ achievedPoints }}
				{{ "Domain.Points" | translate }}
			</span>
		</span>
	</ng-container>

	<ng-container menu *ngIf="props.participant.isTeachingStaffMember">
		<button mat-icon-button [mat-menu-trigger-for]="assignmentMenu">
			<student-mgmt-icon name="more_vert" class="text"></student-mgmt-icon>
		</button>

		<mat-menu #assignmentMenu>
			<ng-container *ngIf="props.participant.isTeachingStaffMember">
				<button mat-menu-item (click)="editClicked.next()">
					<student-mgmt-icon class="mr-4 icon-light" name="edit"></student-mgmt-icon>
					<span class="font-bold">{{ "Action.Edit" | translate }}</span>
				</button>
				<button mat-menu-item (click)="deleteClicked.next()">
					<student-mgmt-icon class="mr-4 icon-light" name="delete"></student-mgmt-icon>
					<span class="font-bold text-red">
						{{ "Action.Delete" | translate }}
					</span>
				</button>
			</ng-container>
		</mat-menu>
	</ng-container>

	<ng-container content>
		<div class="chips">
			<student-mgmt-assignment-type-chip
				[type]="props.assignment.type"
			></student-mgmt-assignment-type-chip>

			<ng-container [ngSwitch]="props.assignment.collaboration">
				<student-mgmt-chip
					*ngSwitchCase="collaborationEnum.GROUP"
					icon="groups"
					color="#009664"
					[text]="'Enum.CollaborationType.' + props.assignment.collaboration | translate"
				></student-mgmt-chip>
				<student-mgmt-chip
					*ngSwitchCase="collaborationEnum.GROUP_OR_SINGLE"
					icon="groups"
					color="#00838f"
					[text]="'Enum.CollaborationType.' + props.assignment.collaboration | translate"
				></student-mgmt-chip>
				<student-mgmt-chip
					*ngSwitchCase="collaborationEnum.SINGLE"
					icon="person"
					color="#7f23c5"
					[text]="'Enum.CollaborationType.' + props.assignment.collaboration | translate"
				></student-mgmt-chip>
				<student-mgmt-chip *ngSwitchDefault></student-mgmt-chip>
			</ng-container>
		</div>

		<div class="flex flex-col" *ngIf="props.assignment.startDate || props.assignment.endDate">
			<span class="startdate" *ngIf="props.assignment.startDate">
				<span class="font-bold uppercase x text-green"
					>{{ "Common.Start" | translate }}:</span
				>
				{{ props.assignment.startDate | date: "dd.MM.YYYY (HH:mm)" }}
			</span>
			<span class="enddate" *ngIf="props.assignment.endDate">
				<span class="font-bold uppercase x text-red">{{ "Common.End" | translate }}:</span>
				{{ props.assignment.endDate | date: "dd.MM.YYYY (HH:mm)" }}
			</span>
		</div>

		<div class="comment" *ngIf="props.assignment.comment">
			<pre class="preformatted">{{ props.assignment.comment }}</pre>
		</div>

		<div class="links" *ngIf="props.assignment.links && props.assignment.links.length > 0">
			<a class="link-none" *ngFor="let link of props.assignment.links" [href]="link.url"
				>#{{ link.name }}</a
			>
		</div>

		<div class="group" *ngIf="props.group">
			<a
				class="font-bold group-title link-none"
				[routerLink]="['/courses', props.courseId, 'groups', props.group.id]"
				>{{ props.group.name }}
			</a>

			<div class="member-list">
				<div class="member" *ngFor="let member of props.group.members">
					<ng-container *ngIf="props.participant.userId !== member.userId">
						<span class="member-name">
							{{ member.displayName }}
						</span>

						<a
							class="text-light link-none"
							[href]="'mailto:' + member.email"
							*ngIf="member.email"
						>
							Email: {{ member.email }}
						</a>
					</ng-container>
				</div>
			</div>
		</div>

		<span class="warning WARNING" *ngIf="props.displayNoGroupWarning">
			<student-mgmt-icon name="warning"></student-mgmt-icon>
			<span class="warning-text">{{ "Text.Group.NoGroupForAssignment" | translate }}</span>
		</span>
	</ng-container>

	<ng-container footer>
		<button
			mat-stroked-button
			*ngIf="props.participant.isStudent && props.assignment.state === 'EVALUATED'"
			(click)="assessmentClicked.next()"
		>
			{{ "Domain.Assessment" | translate }}
		</button>

		<ng-container *ngIf="props.participant.isTeachingStaffMember">
			<a class="link-none" [routerLink]="[props.assignment.id, 'assessments']">
				<button mat-stroked-button>
					{{ "Domain.Assessments" | translate }}
				</button>
			</a>
			<a
				class="link-none"
				[routerLink]="[props.assignment.id, 'assessments', 'registrations']"
				*ngIf="props.assignment.collaboration !== collaborationEnum.SINGLE"
			>
				<button mat-stroked-button>
					{{ "Domain.Registrations" | translate }}
				</button>
			</a>
		</ng-container>
	</ng-container>
</student-mgmt-card>
